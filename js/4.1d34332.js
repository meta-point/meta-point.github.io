(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{959:function(e,t,s){"use strict";s.r(t),function(e){s.d(t,"default",(function(){return m}));s(191);var i=s(49),a=s.n(i),n=s(1),c=s(0),d=s(57),r=s(154),l=s(979),o=s.n(l),b=s(980),h=s.n(b),u=s(981),j=s(983);s(985);class m extends c.Component{constructor(t){super(t),this.init=async()=>{let e=await d.a.Genesis.methods.isOver().call(),t=await d.a.Genesis.methods.maxTokenId().call(),s=await d.a.Genesis.methods.tokenIdCounter().call();this.setState({isEnd:e}),e&&t!=s&&this.countFun(),this.setState({maxTokenId:t,tokenIdCounter:s});let i=await d.a.Genesis.methods.price().call(),a=await d.a.Genesis.methods.dayMaxCount().call(),n=await d.a.Genesis.methods.userSubscribe(this.state.address).call(),c=await d.a.Genesis.methods.maxSubscribed().call();this.setState({dayMaxCount:a,oldPrice:i.fromWei(),price:i.fromWei(),userSubscribe:n,maxSubscribed:c})},this.countFun=async e=>{this.timer=setInterval(async()=>{let e=Date.parse(new Date),t=new Date,s=t.getFullYear()+"/"+(t.getMonth()+1)+"/"+(t.getDate()+1)+" 15:00",i=Date.parse(new Date(s))-e;if(i>0){let e=Math.floor(i/1e3/3600/24),t=Math.floor(i/1e3/3600%24),s=Math.floor(i/1e3/60%60),a=Math.floor(i/1e3%60);this.setState({day:e<10?"0"+e:e,hour:t<10?"0"+t:t,minute:s<10?"0"+s:s,second:a<10?"0"+a:a,isEnd:!0})}else clearInterval(this.timer),this.setState({day:0,hour:0,minute:0,second:0})},1e3)},this.doInvest=()=>{d.a.Genesis.methods.subscribe(1).send({from:e.$address}).on("receipt",()=>{Object(r.a)(e.t("buy.tips1"),"success"),this.setState({loading:!1}),this.buySuccess.showModal(),this.init()}).on("error",t=>{console.log(t),Object(r.a)(e.t("CANCEL"),"error"),this.setState({loading:!1})})},this.buy=async()=>{let t=await d.a.USDTToken.methods.balanceOf(this.state.address).call();if(Number(t.fromWei())<Number(this.state.price))return Object(r.a)("USDT"+e.t("tips.message8"),"error");this.setState({loading:!0});let s=await d.a.USDTToken.methods.allowance(e.$address,d.a.Genesis._address).call({from:e.$address});if(this.state.price.toWei()>s)return this.approve();this.doInvest()},this.approve=async()=>{d.a.USDTToken.methods.approve(d.a.Genesis._address,this.state.price.toWei()).send({from:e.$address}).on("receipt",()=>{Object(r.a)(e.t("tips.message10"),"success"),this.doInvest()}).on("error",t=>{console.log(t),Object(r.a)(e.t("tips.message11"),"error"),this.setState({loading:!1})})},this.action=async e=>{let t=this.state.amount,s=this.state.oldPrice,i=Number(this.state.maxSubscribed)-Number(this.state.userSubscribe);if(console.log(i),1===e){if(1==t)return;t--}else{if(t==i)return;if(t==this.state.maxSubscribed)return;t++}this.setState({amount:t,price:Number(s)*t})},this.state={loading:!1,address:"",oldPrice:0,price:0,maxTokenId:0,tokenIdCounter:"",percents:0,isBuy:!1,isEnd:!1,day1:0,hour1:0,minute1:0,second1:0,day:0,hour:0,minute:0,second:0,isShowExchange:!0,landNum:0,amount:1,userSubscribe:0,maxSubscribed:0,dayMaxCount:0}}async componentDidMount(){window.ethereum&&await d.b.eth.getAccounts((e,t)=>{this.setState({address:t[0]})}),this.init()}render(){const t=this.state;return Object(n.jsxs)("div",{className:"buy",children:[Object(n.jsx)(u.a,{onRef:e=>{this.bindModal=e}}),Object(n.jsx)(j.a,{onRef:e=>{this.buySuccess=e}}),e.isPC?Object(n.jsx)("img",{src:s(965)}):"",Object(n.jsxs)("div",{className:"box",children:[Object(n.jsxs)("div",{className:"left",children:[Object(n.jsx)("div",{className:"subtitle",children:"MetaPoint"}),Object(n.jsx)("div",{className:"title",children:e.t("buy.text1")}),Object(n.jsx)("div",{className:"line"}),e.isPC?"":Object(n.jsx)("img",{src:o.a}),Object(n.jsx)("div",{className:"en"==localStorage.getItem("lang")?"subContent1":"subContent",children:e.t("buy.text2")}),"en"==localStorage.getItem("lang")?Object(n.jsx)("div",{className:"subContent_en",children:e.t("buy.text2_1")}):"",Object(n.jsxs)("div",{className:"bottom",children:[Object(n.jsxs)("div",{className:"time",children:[Object(n.jsx)("div",{className:"title",children:t.tokenIdCounter==t.maxTokenId?e.t("buy.text14"):e.t("buy.text3")}),Object(n.jsxs)("span",{className:"hms",children:[Object(n.jsxs)("div",{children:[Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{className:"same-fang",children:t.hour}),Object(n.jsx)("div",{className:"point",children:":"})]}),Object(n.jsx)("div",{className:"hour",children:e.t("buy.text4_1")})]}),Object(n.jsxs)("div",{children:[Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{className:"same-fang",children:t.minute}),Object(n.jsx)("div",{className:"point",children:":"})]}),Object(n.jsx)("div",{className:"min",children:e.t("buy.text4_2")})]}),Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{children:Object(n.jsx)("div",{className:"same-fang",children:t.second})}),Object(n.jsx)("div",{children:e.t("buy.text4_3")})]})]})]}),Object(n.jsxs)("div",{className:"num",children:[e.t("buy.text5")," ",Object(n.jsx)("span",{children:t.tokenIdCounter==t.maxTokenId?0:t.dayMaxCount})," ",e.t("buy.text5_1")]}),Object(n.jsxs)("div",{className:"ring",children:[Object(n.jsx)("div",{className:"ring1",style:{width:"".concat(Number(this.state.tokenIdCounter)/Number(this.state.maxTokenId)*100,"%")},children:Object(n.jsx)("img",{src:h.a})}),Object(n.jsxs)("div",{className:"total",children:[t.tokenIdCounter,"/",t.maxTokenId]})]})]})]}),Object(n.jsxs)("div",{className:"right",children:[e.isPC?Object(n.jsx)("div",{className:"border",children:Object(n.jsx)("img",{src:o.a})}):"",e.isPC?Object(n.jsx)("div",{className:"name",children:e.t("buy.name")}):"",this.state.maxSubscribed!=this.state.userSubscribe||0==this.state.maxSubscribed?Object(n.jsxs)("div",{className:"buy",children:[Object(n.jsx)("div",{className:"same-left",children:Object(n.jsxs)("div",{className:"price",children:[Object(n.jsx)("div",{children:e.t("buy.text10")})," ",Object(n.jsx)("span",{children:t.price}),"  USDT"]})}),t.tokenIdCounter!=t.maxTokenId?Object(n.jsxs)("div",{className:"submit",children:[Object(n.jsx)(a.a,{disabled:t.isEnd||t.userSubscribe==t.maxSubscribed,loading:t.loading,onClick:this.buy,children:e.t("buy.text9")}),Object(n.jsxs)("div",{className:"content1",children:[Object(n.jsx)("span",{children:"*"}),e.t("buy.text11")," ",t.maxSubscribed," ",e.t("buy.text11_1")]})]}):""!=t.tokenIdCounter?Object(n.jsx)("div",{className:"end",children:e.t("buy.text14")}):""]}):Object(n.jsxs)("div",{className:"maxBuy",children:[e.t("buy.text12")," ",Object(n.jsxs)("a",{href:"#/myNft",children:[" [",e.t("myNft.title"),"] "]}),"  ",e.t("buy.text12_1")]})]})]})]})}}}.call(this,s(24))},965:function(e,t){e.exports="assets/images/d981b521dc22fbd0edb28928b0489374.png"},979:function(e,t){e.exports="assets/images/fdc10af0d9f95d22824a0c2c0a67256f.png"},980:function(e,t){e.exports="assets/images/65e9833ab0cb012521df9206a231cd2e.png"},981:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return u}));s(191);var i=s(954),a=s.n(i),n=s(49),c=s.n(n),d=s(955),r=s.n(d),l=s(1),o=s(0),b=s(57),h=s(154);s(982);class u extends o.Component{constructor(t){super(t),this.componentDidMount=async()=>{await this.init()},this.init=async()=>{},this.showModal=()=>{let e=sessionStorage.getItem("bindAddress");"null"!=e&&this.setState({bindaddress:e}),this.setState({isbind:!0})},this.bind=async()=>{if(""==this.state.bindaddress)return Object(h.b)(e.t("tips.message17"),"error");let t=b.b.utils.isAddress(this.state.bindaddress);if(console.log(t),!t)return Object(h.b)(e.t("tips.message17"),"error");let s=await b.a.Family.methods.parentOf(this.state.bindaddress).call();console.log(s);let i=await b.a.Family.methods.rootAddress().call();if(this.state.bindaddress!=i&&"0x0000000000000000000000000000000000000000"==s)return Object(h.b)(e.t("tips.message17"),"error");b.a.Family.methods.makeRelation(this.state.bindaddress).send({from:e.$address}).on("receipt",t=>{Object(h.b)(e.t("tips.message21"),"success"),this.cancel()}).on("error",t=>{Object(h.b)(e.t("CANCEL"),"error")})},this.Inputs=e=>{this.setState({bindaddress:e.target.value})},this.cancel=()=>{this.setState({isbind:!1})},this.state={address:null,bindaddress:null,isbind:!1},t.onRef&&t.onRef(this)}render(){const t=this.state;return Object(l.jsx)("div",{children:Object(l.jsxs)(a.a,{className:"pc_Bind-Modal",visible:this.state.isbind,footer:null,closable:!0,onCancel:this.cancel,children:[Object(l.jsx)("div",{className:"pc_Bind-Modal-title",children:Object(l.jsx)("span",{children:e.t("bind.text1")})}),Object(l.jsxs)("div",{className:"pc_Bind-Modal-content",children:[Object(l.jsx)("span",{className:"pc_content-titel",children:e.t("bind.text2")}),Object(l.jsx)("div",{className:"border",children:Object(l.jsx)(r.a,{placeholder:e.t("bind.text3"),onChange:!1,onInput:this.Inputs,value:t.bindaddress,type:"text"})}),Object(l.jsx)("div",{className:"bind-btn",children:Object(l.jsx)(c.a,{type:"primary",onClick:this.bind,children:e.t("bind.text4")})})]})]})})}}}).call(this,s(24))},982:function(e,t,s){},983:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return l}));s(191);var i=s(954),a=s.n(i),n=s(49),c=s.n(n),d=s(1),r=s(0);s(57),s(154),s(984);class l extends r.Component{constructor(e){super(e),this.componentDidMount=async()=>{await this.init()},this.init=async()=>{},this.showModal=()=>{this.setState({visible:!0})},this.submit=async()=>{window.location.href="#/myNft"},this.cancel=()=>{this.setState({visible:!1})},this.state={address:null},e.onRef&&e.onRef(this)}render(){const t=this.state;return Object(d.jsx)("div",{children:Object(d.jsxs)(a.a,{className:"box-Modal",visible:t.visible,footer:null,closable:!0,onCancel:this.cancel,children:[Object(d.jsx)("div",{className:"pc_Bind-Modal-title",children:Object(d.jsx)("span",{children:e.t("buySuccess.text1")})}),Object(d.jsxs)("div",{className:"border-Modal-content",children:[Object(d.jsxs)("div",{className:"buy-success-content",children:[e.t("buy.text12")," ",Object(d.jsxs)("a",{href:"#/myNft",children:[" [",e.t("myNft.title"),"] "]}),"  ",e.t("buy.text12_1")]}),Object(d.jsxs)("div",{className:"bind-btn",children:[Object(d.jsx)(c.a,{type:"primary",onClick:this.cancel,children:e.t("buySuccess.text2")}),Object(d.jsx)(c.a,{type:"primary",onClick:this.submit,children:e.t("buySuccess.text3")})]})]})]})})}}}).call(this,s(24))},984:function(e,t,s){},985:function(e,t,s){}}]);