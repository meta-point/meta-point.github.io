(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{661:function(t,e,s){"use strict";s.r(e),function(t){s.d(e,"default",(function(){return U}));var a=s(30),n=s.n(a),r=s(35),i=s.n(r),d=s(15),c=s.n(d),o=s(20),l=s.n(o),h=(s(33),s(47),s(86),s(1)),u=s(262),m=s(133),p=s.n(m),j=s(272),b=s.n(j),O=s(274),f=s.n(O),g=s(83),w=s.n(g),x=s(277),y=s.n(x),v=s(278),F=s.n(v),I=s(190),S=s(110),M=s.n(S),N=s(273),D=s.n(N),T=s(275),q=s.n(T),L=s(276),k=s.n(L),A=s(2),C=s(4),_=s(279),B=(s(662),s(0));function P(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function R(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?P(Object(s),!0).forEach((function(e){l()(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):P(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}class U extends h.Component{constructor(e){var s;super(e),s=this,this.componentDidMount=async()=>{await this.initinfo()},this.initinfo=async()=>{window.ethereum&&await A.b.eth.getAccounts((t,e)=>{this.setState({address:e[0]})});let t=location.hash.split("?")[1].split("&"),e={};for(let s=0;s<t.length;s++){let a=t[s].split("=");e[a[0]]=a[1]}let s=JSON.parse(decodeURI(e.friendInfo)),a=JSON.parse(decodeURI(e.landIndex));console.log(s),this.setState({ingoA:s,balanceOf:s.landList.length,_address:s.address,nFT:a,name:s.address.slice(-4),_landAddress:s.landList[a].address}),this.setHomeDate(s.landList[a].id)},this.setHomeDate=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;console.log(t);const e=new A.b.BatchRequest,a=await Object(C.b)();e.add(A.a.MetaLand.methods.balanceOf(s.state._address).call.request()),e.requestManager.sendBatch(e.requests,async(e,n)=>{if(!e){const e=("string"==typeof n[0]?n[0]:n[0].result).decode(["uint256"]),r=await s.getLandList(e),i=await s.getLandInfoList(r);let d=0,c=i[0].supply.fromWei().toFixed(2),o=17,l=!1,h="";t=t||r[0].id;for(let n=0;n<e;n++)if(t==r[n].id&&(c=i[n].supply.fromWei().toFixed(2),i[n].isActive)){o=18,-1!=s.state.timer1&&clearInterval(s.state.timer1),s.countdown(parseInt(i[n].lastTime)),a>parseInt(i[n].lastTime)+86400&&(o=19,l=!0),h=r[n].address,d=(await A.a.MetaFarm.methods.harvestInfo(r[n].address).call({from:"0x000000000000000000000000000000000000dead"}))[0].fromWei().toFixed(2)}s.setState({canTake:l,landSupply:c,currSupply:d,landStatus:o,landId:t,_landAddress:h});let u=setInterval(async()=>{s.setState({landImg2state:!1,landImg1state:!1}),clearInterval(u)},2500)}})},this.getLandList=t=>new Promise(e=>{const s=new A.b.BatchRequest;for(let e=0;e<t;e++)s.add(A.a.MetaLand.methods.tokenOfOwnerByIndex(this.state._address,e).call.request());s.requestManager.sendBatch(s.requests,(t,s)=>{t||e(s.map(t=>{const e=("string"==typeof t?t:t.result).decode(["uint256"]);return{id:e,address:e.toAddress()}}))})}),this.getLandInfoList=t=>new Promise(e=>{const s=new A.b.BatchRequest;for(let e=0;e<t.length;e++)s.add(A.a.MetaFarm.methods.LandFarmInfo(t[e].address).call.request()),s.add(A.a.MetaFarm.methods.landIsActived(t[e].address).call.request());s.requestManager.sendBatch(s.requests,(t,s)=>{if(!t){const t=[R(R({},("string"==typeof s[0]?s[0]:s[0].result).decode([{name:"supply",type:"uint256"},{name:"reward",type:"uint256"},{name:"taked",type:"uint256"},{name:"takedUSD",type:"uint256"},{name:"rewardDebt",type:"uint256"},{name:"lastTime",type:"uint256"}])),{},{isActive:s[1].result.decode(["bool"])})];for(let e=2;e<s.length;e+=2)t.push(R(R({},s[e].result.decode([{name:"supply",type:"uint256"},{name:"reward",type:"uint256"},{name:"taked",type:"uint256"},{name:"takedUSD",type:"uint256"},{name:"rewardDebt",type:"uint256"},{name:"lastTime",type:"uint256"}])),{},{isActive:s[e+1].result.decode(["bool"])}));e(t)}})}),this.countdown=async t=>{console.log(t);let e=t+9e4,s=e-t,a=M.a,n=setInterval(async()=>{const n=await Object(C.b)();if(n>e)return this.setState({tree:k.a,percentage:100,hour:"00",minute:"00",second:"00",showCountdown:!1}),clearInterval(this.state.timer1);n>t+57600?a=q.a:n>t+28800&&(a=D.a);let r=e-n,i=Math.floor(r/3600),d=Math.floor((r-3600*i)/60),c=r-3600*i-60*d;this.setState({tree:a,showCountdown:!0,percentage:(s-r)/s*100,hour:i<10?"0".concat(i):i,minute:d<10?"0".concat(d):d,second:c<10?"0".concat(c):c})},1e3);this.setState({timer1:n})},this.harvest=async()=>{if(this.state.showCountdown)return Object(C.c)(t.t("land.tips3"),"error");const e=new A.b.BatchRequest;e.add(A.a.MetaFarm.methods.LandFarmInfo(this.state._landAddress).call.request()),e.add(A.a.MetaTax.methods.balanceOf(this.state._address).call.request()),e.add(A.a.MetaFarm.methods.harvestInfo(this.state._landAddress).call.request({from:"0x000000000000000000000000000000000000dead"})),e.add(A.a.MetaFarm.methods.userTakeUSD(this.state._address).call.request()),e.add(A.a.MetaFarm.methods.userMaxEarnUSD(this.state._address).call.request()),e.requestManager.sendBatch(e.requests,async(e,s)=>{if(!e){const{supply:e}=("string"==typeof s[0]?s[0]:s[0].result).decode([{name:"supply",type:"uint256"},{name:"reward",type:"uint256"},{name:"taked",type:"uint256"},{name:"takedUSD",type:"uint256"},{name:"rewardDebt",type:"uint256"},{name:"lastTime",type:"uint256"}]),a=s[1].result.toBN(),n=s[2].result.decode(["uint256","uint256","uint256"]),r=n[2],i=n[1],d=s[3].result.toBN(),c=s[4].result.toBN().toFixed(),o=await A.a.MinistryLandResources.methods.tokenAmount(A.a.MetaPoint.options.address,i).call(),l=d.plus(o).toFixed(0);if(a.lt(r))return Object(C.c)(t.t("Friends.tips4"),"error");if(n[1].toBN().gt(e))return Object(C.c)(t.t("Friends.tips6"),"error");if(Number(l)>=Number(c))return Object(C.c)(t.t("Friends.tips9"),"error");const h=A.a.MetaFarm.methods.harvest(this.state._landAddress);h.call({from:t.$address},e=>{console.log(e),e||h.send({from:t.$address}).on("receipt",()=>{Object(C.c)(t.t("land.tips5"),"success"),this.initinfo()}).on("error",()=>{Object(C.c)(t.t("cancel"),"error"),this.setState({loading:!1})})})}})},this.next=async()=>{let e=await A.a.MetaLand.methods.balanceOf(this.state._address).call(),s=this.state.nFT;if(e-1==s)return Object(C.c)(t.t("Friends.tips8"),"error");s++,this.setState({nFT:s,landImg1state:!0}),this.setHomeDate(this.state.ingoA.landList[this.state.nFT].id)},this.prev=async()=>{let e=this.state.nFT;if(0!=e&&e--,this.setState({nFT:e}),this.state.nFT<=0)return this.setState({nFT:0}),this.setHomeDate(this.state.ingoA.landList[this.state.nFT].id),Object(C.c)(t.t("Friends.tips8"),"error");this.setState({nFT:e,landImg2state:!0}),this.setHomeDate(this.state.ingoA.landList[e].id)},this.Continuetovisit=()=>{this.warehouseModal.showModal()},this.state={isShow:!0,isShow1:!0,landImg1state:!1,landImg2state:!1,hour:"00",minute:"00",second:"00",percentage:0,ManorNumber:0,address:null,landAddress:null,tree:M.a,showCountdown:!0,timer1:-1,capacitybalanceOf:0,showData:!1,_address:null,landId:0,landSupply:0,currSupply:0,landStatus:17,canTake:!1,_landAddress:null,nFT:0,harvestInfo1:null,MetaTaxbalanceOf:0,balanceOf:0,name:null,ingoA:null}}toggleShowDate(){this.setState({showData:!this.state.showData})}render(){const e=this.state;return Object(B.jsxs)("div",{className:"Friendss",children:[Object(B.jsx)(u.a,{}),Object(B.jsx)(_.a,{onRef:t=>this.warehouseModal=t,initinfo:this.initinfo}),Object(B.jsxs)("div",{className:"leftimgxs",children:[0==this.state.nFT?Object(B.jsx)("div",{}):Object(B.jsx)("img",{onClick:this.prev,src:p.a,alt:""}),this.state.nFT==this.state.balanceOf-1?Object(B.jsx)("div",{}):Object(B.jsx)("img",{onClick:this.next,src:f.a,alt:""})]}),Object(B.jsxs)("div",{className:e.landImg1state?"Friendssland2 landImg1rigthtstate":e.landImg2state?"Friendssland2 landImg1leftstate":"Friendssland2",children:[Object(B.jsx)("img",{src:w.a}),Object(B.jsxs)("div",{className:"CountdownProgress",children:[Object(B.jsx)("img",{className:"treeImg",src:e.tree,onClick:this.harvest}),Object(B.jsxs)("div",{className:"energy",onClick:this.harvest,children:[Object(B.jsxs)("div",{className:"energy1",children:[Object(B.jsx)("img",{className:e.showCountdown?"tenergy1":"",src:y.a,alt:""}),Object(B.jsxs)("div",{className:"pot",children:[Object(B.jsx)("span",{children:e.currSupply}),Object(B.jsx)("span",{children:"pot"})]})]}),e.showCountdown?"":Object(B.jsx)("img",{src:F.a,alt:""}),e.showCountdown?Object(B.jsxs)("div",{className:"rate",children:[Object(B.jsx)("img",{src:b.a,alt:""}),Object(B.jsxs)("div",{className:"Countdown",children:[Object(B.jsx)("div",{children:e.hour}),":",Object(B.jsx)("div",{children:e.minute}),":",Object(B.jsx)("div",{children:e.second})]})]}):""]})]}),Object(B.jsxs)("div",{className:"contentx",children:[Object(B.jsxs)("span",{children:[t.t("topMenu-setup.text10"),e.name]}),Object(B.jsxs)(i.a,{children:[Object(B.jsx)(c.a,{span:12,children:"IDï¼š"}),Object(B.jsx)(c.a,{span:12,children:e.landId}),Object(B.jsx)(c.a,{span:12,children:t.t("landInformation.text15")}),Object(B.jsxs)(c.a,{span:12,children:[" ",e.landSupply]}),Object(B.jsx)(c.a,{span:12,children:t.t("landInformation.text9")}),Object(B.jsx)(c.a,{span:12,children:Object(B.jsx)("span",{children:t.t("landInformation.text"+e.landStatus)})})]})]}),Object(B.jsxs)("div",{className:"icon7",children:[Object(B.jsx)(I.a,{to:{pathname:"/"},className:"icon1",children:Object(B.jsx)(n.a,{className:"icon",children:t.t("Friends.text1")})}),Object(B.jsx)(n.a,{className:"icon2",onClick:this.Continuetovisit,children:t.t("Friends.text2")})]})]})]})}}}.call(this,s(28))},662:function(t,e,s){}}]);